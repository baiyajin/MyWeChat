<Window x:Class="SalesChampion.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MyWeChat" Height="600" Width="900" Icon="Resources/favicon.ico"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题栏 -->
        <Border Grid.Row="0" Background="#07C160" Padding="15,10">
            <TextBlock Text="MyWeChat" FontSize="18" FontWeight="Bold" Foreground="White"/>
        </Border>

        <!-- 主内容区 -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- 左侧功能区 -->
            <StackPanel Grid.Column="0" Margin="0,0,20,0">
                <!-- 连接状态 -->
                <Border Background="White" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="连接状态" FontWeight="Bold" Margin="0,0,0,10"/>
                        
                        <!-- 微信账号信息（登录后显示） -->
                        <StackPanel Name="AccountInfoPanel" Orientation="Horizontal" Margin="0,0,0,10" Visibility="Collapsed">
                            <Border Width="40" Height="40" Margin="0,0,10,0" CornerRadius="20" 
                                    Background="#E0E0E0" BorderBrush="#CCCCCC" BorderThickness="1">
                                <Image Name="AccountAvatar" Stretch="UniformToFill">
                                    <Image.Clip>
                                        <EllipseGeometry Center="20,20" RadiusX="20" RadiusY="20"/>
                                    </Image.Clip>
                                </Image>
                            </Border>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Name="AccountNickName" Text="未知" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,2"/>
                                <TextBlock Name="AccountWeChatId" Text="" FontSize="11" Foreground="#666666"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- 未连接状态 -->
                        <StackPanel Name="NotConnectedPanel">
                            <TextBlock Name="StatusText" Text="微信: 未连接" Margin="0,0,0,5"/>
                            <TextBlock Name="VersionText" Text="版本: 未知" Margin="0,0,0,5"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- 微信账号头像（登录后显示在按钮上方） -->
                <Border Background="White" Padding="15" Margin="0,0,0,15" CornerRadius="5" Visibility="Collapsed" Name="AvatarPanel">
                    <StackPanel HorizontalAlignment="Center">
                        <Border Width="60" Height="60" Margin="0,0,0,10" CornerRadius="30" 
                                Background="#E0E0E0" BorderBrush="#CCCCCC" BorderThickness="2">
                            <Image Name="TopAvatar" Stretch="UniformToFill">
                                <Image.Clip>
                                    <EllipseGeometry Center="30,30" RadiusX="30" RadiusY="30"/>
                                </Image.Clip>
                            </Image>
                        </Border>
                        <TextBlock Name="TopNickName" Text="微信用户" FontSize="14" FontWeight="SemiBold" 
                                   HorizontalAlignment="Center" TextAlignment="Center"/>
                        <TextBlock Name="TopWeChatId" Text="" FontSize="11" Foreground="#666666" 
                                   HorizontalAlignment="Center" TextAlignment="Center" Margin="0,2,0,0"/>
                    </StackPanel>
                </Border>

                <!-- 操作按钮 -->
                <Button Name="BtnLoginWeChat" Content="登录微信" Click="BtnLoginWeChat_Click" 
                        Margin="0,0,0,10" Padding="10" Background="#07C160" Foreground="White" 
                        BorderThickness="0" Cursor="Hand" FontSize="14"/>
                <Button Name="BtnSyncContacts" Content="同步好友" Click="BtnSyncContacts_Click" 
                        Margin="0,0,0,10" Padding="10" Background="#07C160" Foreground="White" 
                        BorderThickness="0" Cursor="Hand" FontSize="14"/>
                <Button Name="BtnSyncMoments" Content="同步朋友圈" Click="BtnSyncMoments_Click" 
                        Margin="0,0,0,10" Padding="10" Background="#07C160" Foreground="White" 
                        BorderThickness="0" Cursor="Hand" FontSize="14"/>
                <Button Name="BtnSyncTags" Content="同步标签" Click="BtnSyncTags_Click" 
                        Margin="0,0,0,20" Padding="10" Background="#07C160" Foreground="White" 
                        BorderThickness="0" Cursor="Hand" FontSize="14"/>
                
                <!-- Logo和版本信息 -->
                <StackPanel Margin="0,20,0,0" HorizontalAlignment="Center">
                    <Image Name="LogoImage" Source="Resources/favicon.ico" Width="64" Height="64" 
                           Opacity="0.6" Margin="0,0,0,10"/>
                    <TextBlock Name="AppVersionText" Text="版本号: 1.0.0" 
                               HorizontalAlignment="Center" FontSize="12" Foreground="#666666"/>
                </StackPanel>
            </StackPanel>

            <!-- 右侧内容区 -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="200"/>
                </Grid.RowDefinitions>

                <!-- 账号列表表格 -->
                <Border Grid.Row="0" Background="White" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                    <DataGrid Name="AccountGrid" AutoGenerateColumns="False" HeadersVisibility="Column" 
                              IsReadOnly="True" SelectionMode="Single">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="客户端" Binding="{Binding Client}" Width="100"/>
                            <DataGridTextColumn Header="公司名称" Binding="{Binding CompanyName}" Width="150"/>
                            <DataGridTextColumn Header="昵称" Binding="{Binding NickName}" Width="150"/>
                            <DataGridTextColumn Header="备注" Binding="{Binding Remark}" Width="150"/>
                            <DataGridTextColumn Header="当前绑定账号" Binding="{Binding BoundAccount}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <!-- App命令执行日志 -->
                <Border Grid.Row="1" Background="White" Padding="15" Margin="0,0,0,15" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="App命令执行日志" FontWeight="Bold" VerticalAlignment="Center"/>
                            <Button Name="BtnCopyLog" Content="复制日志" Click="BtnCopyLog_Click" 
                                    Margin="10,0,0,0" Padding="5,2" Background="#07C160" Foreground="White" 
                                    BorderThickness="0" Cursor="Hand" FontSize="12" VerticalAlignment="Center"/>
                            <Button Name="BtnClearLog" Content="清空日志" Click="BtnClearLog_Click" 
                                    Margin="5,0,0,0" Padding="5,2" Background="#999999" Foreground="White" 
                                    BorderThickness="0" Cursor="Hand" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <RichTextBox Name="LogRichTextBox" IsReadOnly="True" 
                                         FontFamily="Consolas" FontSize="11" Background="#F8F8F8"
                                         BorderThickness="1" BorderBrush="#CCCCCC" VerticalScrollBarVisibility="Auto"
                                         HorizontalScrollBarVisibility="Auto">
                                <FlowDocument PageWidth="999999">
                                    <Paragraph Margin="0"/>
                                </FlowDocument>
                            </RichTextBox>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- 底部信息 -->
                <Border Grid.Row="2" Background="#F0F0F0" Padding="15" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="注意:所有操作的微信都需要通过上方按钮启动登录,请勿直接在电脑桌面进行登录启动" 
                                   Foreground="Red" TextWrapping="Wrap" Margin="0,0,0,10"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Name="MachineCodeText" Text="机器码: " Margin="0,0,20,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>

