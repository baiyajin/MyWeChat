<Window x:Class="SalesChampion.Windows.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MyWeChat" Height="600" Width="900" Icon="Resources/favicon.ico"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F5F5F5"
        Loaded="MainWindow_Loaded">
    <Grid>
        <!-- 主内容区 -->
        <Grid Margin="20">
            <!-- 右侧内容区 -->
            <Grid>
                <!-- App命令执行日志 -->
                <Border Background="White" Padding="15" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="App命令执行日志" FontWeight="Bold" VerticalAlignment="Center"/>
                            <Button Name="BtnCopyLog" Content="复制日志" Click="BtnCopyLog_Click" 
                                    Margin="10,0,0,0" Padding="5,2" Background="#07C160" Foreground="White" 
                                    BorderThickness="0" Cursor="Hand" FontSize="12" VerticalAlignment="Center"/>
                            <Button Name="BtnClearLog" Content="清空日志" Click="BtnClearLog_Click" 
                                    Margin="5,0,0,0" Padding="5,2" Background="#999999" Foreground="White" 
                                    BorderThickness="0" Cursor="Hand" FontSize="12" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ScrollViewer Grid.Row="1" 
                                     VerticalScrollBarVisibility="Auto" 
                                     HorizontalScrollBarVisibility="Visible">
                            <RichTextBox Name="LogRichTextBox" IsReadOnly="True" 
                                         FontFamily="Consolas" FontSize="11" Background="#F8F8F8"
                                         BorderThickness="1" BorderBrush="#CCCCCC" 
                                         VerticalScrollBarVisibility="Disabled"
                                         HorizontalScrollBarVisibility="Disabled">
                                <FlowDocument PageWidth="999999">
                                    <Paragraph Margin="0"/>
                                </FlowDocument>
                            </RichTextBox>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
        
        <!-- 关闭进度遮罩层 - 使用Canvas确保在最上层 -->
        <Canvas 
                Name="ClosingOverlayCanvas"
                Visibility="Collapsed"
                Background="#80000000"
                Panel.ZIndex="9999">
            <Border Name="ClosingOverlayBorder"
                    Background="White" 
                    CornerRadius="10" 
                    Padding="30" 
                    Width="400" 
                    Height="280"
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="正在关闭程序..." 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Margin="0,0,0,25"
                               HorizontalAlignment="Center"/>
                    
                    <!-- 圆环进度 -->
                    <Grid Width="120" Height="120" Margin="0,0,0,20" HorizontalAlignment="Center">
                        <!-- 背景圆环 -->
                        <Ellipse Width="120" Height="120" 
                                 Stroke="#E0E0E0" 
                                 StrokeThickness="8"/>
                        <!-- 进度圆环 -->
                        <Path Name="ClosingProgressPath" 
                              Stroke="#07C160" 
                              StrokeThickness="8"
                              StrokeStartLineCap="Round"
                              StrokeEndLineCap="Round">
                            <Path.Data>
                                <PathGeometry>
                                    <PathFigure StartPoint="60,10">
                                        <ArcSegment x:Name="ClosingProgressArc"
                                                    Size="50,50"
                                                    SweepDirection="Clockwise"
                                                    IsLargeArc="False"/>
                                    </PathFigure>
                                </PathGeometry>
                            </Path.Data>
                        </Path>
                        <!-- 进度文本 -->
                        <TextBlock Name="ClosingProgressText" 
                                   Text="0%" 
                                   FontSize="20" 
                                   FontWeight="Bold"
                                   Foreground="#07C160"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Grid>
                    
                    <TextBlock Name="ClosingStatusText" 
                               Text="准备关闭..." 
                               FontSize="14" 
                               Foreground="#666666"
                               TextWrapping="Wrap"
                               HorizontalAlignment="Center"
                               TextAlignment="Center"
                               MaxWidth="340"
                               Margin="0,0,0,10"/>
                </StackPanel>
            </Border>
        </Canvas>
    </Grid>
</Window>

